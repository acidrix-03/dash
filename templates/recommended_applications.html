{% extends "base.html" %}
{% block content %}

<div class="container mt-5">
    <h2 class="text-center mb-4">Recommended Applications</h2>

    <!-- CTO Applications Section -->
    <div class="application-section mb-4">
        <h3>CTO Applications</h3>
        <input type="text" id="ctoFilterInput" onkeyup="filterTable('ctoTable', 'ctoFilterInput')" placeholder="Search for names.." class="form-control mb-3">
        <table id="ctoTable" class="table table-striped table-bordered">
            <thead class="thead-dark">
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Position</th>
                    <th>Days</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Date Recommended</th>
                </tr>
            </thead>
            <tbody>
                {% for app in cto_recommended_apps %}
                <tr>
                    <td>{{ app[0] }}</td>
                    <td>{{ app[3] }}</td>
                    <td>{{ app[4] }}</td>
                    <td>{{ app[5] }}</td>
                    <td>{{ app[6] }}</td>
                    <td>{{ app[7] }}</td>
                    <td>{{ app[11] }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Leave Applications Section -->
    <div class="application-section mb-4">
        <h3>Leave Applications</h3>
        <input type="text" id="leaveFilterInput" onkeyup="filterTable('leaveTable', 'leaveFilterInput')" placeholder="Search for names.." class="form-control mb-3">
        <table id="leaveTable" class="table table-striped table-bordered">
            <thead class="thead-dark">
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Position</th>
                    <th>Days</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Date Recommended</th>
                </tr>
            </thead>
            <tbody>
                {% for app in leave_recommended_apps %}
                <tr>
                    <td>{{ app[0] }}</td>
                    <td>{{ app[1] }}</td>
                    <td>{{ app[2] }}</td>
                    <td>{{ app[3] }}</td>
                    <td>{{ app[4] }}</td>
                    <td>{{ app[5] }}</td>
                    <td>{{ app[7] }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Travel Authorities Section -->
    <div class="application-section mb-4">
        <h3>Travel Authorities</h3>
        <input type="text" id="travelFilterInput" onkeyup="filterTable('travelTable', 'travelFilterInput')" placeholder="Search for names.." class="form-control mb-3">
        <table id="travelTable" class="table table-striped table-bordered">
            <thead class="thead-dark">
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th>Position</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Destination</th>
                    <th>Purpose</th>
                    <th>Date Recommended</th>
                </tr>
            </thead>
            <tbody>
                {% for app in travel_recommended_apps %}
                <tr>
                    <td>{{ app[1] }}</td>
                    <td>{{ app[3] }}</td>
                    <td>{{ app[4] }}</td>
                    <td>{{ app[7] }}</td>
                    <td>{{ app[8] }}</td>
                    <td>{{ app[9] }}</td>
                    <td>{{ app[5] }}</td>
                    <td>{{ app[11] }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="text-center mt-4">
        <a href="{{ url_for('recommender_dashboard') }}" class="btn btn-secondary mb-3">Go back to Dashboard</a>
    </div>
</div>

<script>
function filterTable(tableId, inputId) {
    var input, filter, table, tr, td, i, j, txtValue;
    input = document.getElementById(inputId);
    filter = input.value.toLowerCase();
    table = document.getElementById(tableId);
    tr = table.getElementsByTagName("tr");

    // Loop through all table rows, and hide those who don't match the search query
    for (i = 1; i < tr.length; i++) {
        tr[i].style.display = "none"; // Hide the row initially
        td = tr[i].getElementsByTagName("td");
        for (j = 0; j < td.length; j++) {
            if (td[j]) {
                txtValue = td[j].textContent || td[j].innerText;
                if (txtValue.toLowerCase().indexOf(filter) > -1) {
                    tr[i].style.display = ""; // Show the row if it matches
                    break; // No need to check other cells in the row
                }
            }
        }
    }
}
</script>

<style>
body {
    background-color: #f8f9fa;
}
.application-section {
    background-color: #ffffff;
    border-radius: 0.5rem;
    padding: 20px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}
.table th {
    background-color: #007bff;
    color: white;
}
.table tbody tr:hover {
    background-color: #e9ecef;
}
.btn-secondary {
    border-radius: 0.5rem;
}
.btn-secondary:hover {
    background-color: #6c757d;
}
</style>

{% endblock %}
